"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[181],{86181:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var r=n(43001),i=n(7023),o=n(3827),a=n.n(o),s=n(26925),l=n(45754),c=n(20599),m=n(77284),u=n(73704);function p(e){let{viewportData:t,viewportIndex:n,element:i,imageSliceData:o,setImageSliceData:a,scrollbarHeight:c,servicesManager:u}=e;const{cineService:p,cornerstoneViewportService:d}=u.services;return(0,r.useEffect)((()=>{if(!t)return;const e=d.getCornerstoneViewportByIndex(n);if(e)if(t.viewportType!==l.Enums.ViewportType.STACK){if(t.viewportType===l.Enums.ViewportType.ORTHOGRAPHIC){const t=l.utilities.getImageSliceDataForVolumeViewport(e);if(!t)return;const{imageIndex:n,numberOfSlices:r}=t;a({imageIndex:n,numberOfSlices:r})}}else{const n=e.getCurrentImageIdIndex();a({imageIndex:n,numberOfSlices:t.data.imageIds.length})}}),[n,t]),(0,r.useEffect)((()=>{if(t?.viewportType!==l.Enums.ViewportType.STACK)return;const e=e=>{const{newImageIdIndex:n}=e.detail;a({imageIndex:n,numberOfSlices:t.data.imageIds.length})};return i.addEventListener(l.Enums.Events.STACK_VIEWPORT_SCROLL,e),()=>{i.removeEventListener(l.Enums.Events.STACK_VIEWPORT_SCROLL,e)}}),[t,i]),(0,r.useEffect)((()=>{if(t?.viewportType!==l.Enums.ViewportType.ORTHOGRAPHIC)return;const e=e=>{const{imageIndex:t,numberOfSlices:n}=e.detail;a({imageIndex:t,numberOfSlices:n})};return i.addEventListener(l.Enums.Events.VOLUME_NEW_IMAGE,e),()=>{i.removeEventListener(l.Enums.Events.VOLUME_NEW_IMAGE,e)}}),[t,i]),r.createElement(m.Ln,{onChange:e=>((e,t)=>{const n=d.getViewportInfoByIndex(t).getViewportId(),r=d.getCornerstoneViewport(n),{isCineEnabled:o}=p.getState();o&&(p.stopClip(i),p.setCine({id:t,isPlaying:!1})),s.utilities.jumpToSlice(r.element,{imageIndex:e,debounceLoading:!0})})(e,n),max:o.numberOfSlices?o.numberOfSlices-1:0,height:c,value:o.imageIndex})}p.propTypes={viewportData:a().object,viewportIndex:a().number.isRequired,element:a().instanceOf(Element),scrollbarHeight:a().string,imageSliceData:a().object.isRequired,setImageSliceData:a().func.isRequired,servicesManager:a().object.isRequired};const d=p;var f=n(45451),v=n(71271),E=n.n(v);function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(null!==e)return parseFloat(e).toFixed(t)}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MMM D, YYYY";return E()(e,"YYYYMMDD").format(t)}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HH:mm:ss";return E()(e,"HH:mm:ss").format(t)}function S(e){if(!e)return"";const t=e.split("^").filter((e=>!!e)).join(", ").trim();return","===t||""===t?"":t}const y=1e-4;function b(e){let{voi:t,customization:n}=e;const{windowWidth:i,windowCenter:o}=t;return"number"!=typeof o||"number"!=typeof i?null:r.createElement("div",{className:"overlay-item flex flex-row",style:{color:n&&n.color||void 0}},r.createElement("span",{className:"mr-1 shrink-0"},"W:"),r.createElement("span",{className:"ml-1 mr-2 font-light shrink-0"},i.toFixed(0)),r.createElement("span",{className:"mr-1 shrink-0"},"L:"),r.createElement("span",{className:"ml-1 font-light shrink-0"},o.toFixed(0)))}function T(e){let{scale:t,customization:n}=e;return r.createElement("div",{className:"overlay-item flex flex-row",style:{color:n&&n.color||void 0}},r.createElement("span",{className:"mr-1 shrink-0"},"Zoom:"),r.createElement("span",{className:"font-light"},t.toFixed(2),"x"))}function h(e){let{instanceNumber:t,imageSliceData:n,customization:i}=e;const{imageIndex:o,numberOfSlices:a}=n;return r.createElement("div",{className:"overlay-item flex flex-row",style:{color:i&&i.color||void 0}},r.createElement("span",{className:"mr-1 shrink-0"},"I:"),r.createElement("span",{className:"font-light"},null!=t?`${t} (${o+1}/${a})`:`${o+1}/${a}`))}function O(e){let{element:t,viewportData:n,imageSliceData:i,viewportIndex:o,servicesManager:a}=e;const{toolbarService:s,cornerstoneViewportService:c,customizationService:u}=a.services,[p,d]=(0,r.useState)({windowCenter:null,windowWidth:null}),[v,E]=(0,r.useState)(1),[O,C]=(0,r.useState)([]),{imageIndex:D}=i,x=u.getModeCustomization("cornerstoneOverlayTopLeft"),V=u.getModeCustomization("cornerstoneOverlayTopRight"),M=u.getModeCustomization("cornerstoneOverlayBottomLeft"),R=u.getModeCustomization("cornerstoneOverlayBottomRight"),N=(0,r.useMemo)((()=>null!=n?function(e,t){let n=null;if(e.viewportType===l.Enums.ViewportType.STACK)n=e.data.imageIds[t];else if(e.viewportType===l.Enums.ViewportType.ORTHOGRAPHIC){const r=e.data;if(r&&1==r.length){n=r[0].imageIds[t]}}return n&&l.metaData.get("instance",n)||{}}(n,D):null),[n,D]),P=(0,r.useMemo)((()=>null!=n?function(e,t,n,r){let i;if(e.viewportType===l.Enums.ViewportType.STACK){if(i=function(e,t){const n=e.data.imageIds,r=n[t];if(!r)return;const i=l.metaData.get("generalImageModule",r)||{},{instanceNumber:o}=i;if(n.length<=1)return;return parseInt(o)}(e,n),!i&&0!==i)return null}else e.viewportType===l.Enums.ViewportType.ORTHOGRAPHIC&&(i=function(e,t,n,r){const i=e.volumes;if(!i||i.length>1)return;const o=i[0],{direction:a,imageIds:s}=o,c=r.getCornerstoneViewportByIndex(n);if(!c)return;const m=c.getCamera(),{viewPlaneNormal:u}=m,p=a.slice(6,9),d=f.R3.cross(f.R3.create(),u,p);if(f.R3.length(d)<y){const e=s[t];if(!e)return{};const{instanceNumber:n}=l.metaData.get("generalImageModule",e)||{};return parseInt(n)}}(e,n,t,r));return i}(n,o,D,c):null),[n,o,D,c]);(0,r.useEffect)((()=>{C(s.getActiveTools())}),[]),(0,r.useEffect)((()=>{const e=e=>{const{range:t}=e.detail;if(!t)return;const{lower:n,upper:r}=t,{windowWidth:i,windowCenter:o}=l.utilities.windowLevel.toWindowLevel(n,r);d({windowCenter:o,windowWidth:i})};return t.addEventListener(l.Enums.Events.VOI_MODIFIED,e),()=>{t.removeEventListener(l.Enums.Events.VOI_MODIFIED,e)}}),[o,n,p,t]),(0,r.useEffect)((()=>{const e=e=>{const{previousCamera:n,camera:r}=e.detail;if(n.parallelScale!==r.parallelScale||n.scale!==r.scale){const e=c.getCornerstoneViewportByIndex(o);if(!e)return;const n=e.getImageData();if(!n)return;if(r.scale)return void E(r.scale);const{spacing:i}=n,a=t.clientHeight*i[0]*.5/r.parallelScale;E(a)}};return t.addEventListener(l.Enums.Events.CAMERA_MODIFIED,e),()=>{t.removeEventListener(l.Enums.Events.CAMERA_MODIFIED,e)}}),[o,n,c,t]),(0,r.useEffect)((()=>{const{unsubscribe:e}=s.subscribe(s.EVENTS.TOOL_BAR_STATE_MODIFIED,(()=>{C(s.getActiveTools())}));return()=>{e()}}),[s]);const L=(0,r.useCallback)((e=>{const s={element:t,viewportData:n,imageSliceData:i,viewportIndex:o,servicesManager:a,customization:e,formatters:{formatPN:S,formatDate:I,formatTime:w,formatNumberPrecision:g},instance:N,voi:p,scale:v,instanceNumber:P};if("ohif.overlayItem.windowLevel"===e.customizationType)return r.createElement(b,s);if("ohif.overlayItem.zoomLevel"===e.customizationType)return r.createElement(T,s);if("ohif.overlayItem.instanceNumber"===e.customizationType)return r.createElement(h,s);{const t=u.transform(e);if("function"==typeof t.content)return t.content(s)}}),[t,n,i,o,a,u,N,p,v,P]),A=(0,r.useCallback)((()=>{const e=x?.items||[{id:"WindowLevel",customizationType:"ohif.overlayItem.windowLevel"}];return r.createElement(r.Fragment,null,e.map(((e,t)=>r.createElement("div",{key:`topLeftOverlayItem_${t}`},L(e)))))}),[x,L]),_=(0,r.useCallback)((()=>{const e=V?.items||[{id:"InstanceNmber",customizationType:"ohif.overlayItem.instanceNumber"}];return r.createElement(r.Fragment,null,e.map(((e,t)=>r.createElement("div",{key:`topRightOverlayItem_${t}`},L(e)))))}),[V,L]),k=(0,r.useCallback)((()=>{const e=M?.items||[];return r.createElement(r.Fragment,null,e.map(((e,t)=>r.createElement("div",{key:`bottomLeftOverlayItem_${t}`},L(e)))))}),[M,L]),H=(0,r.useCallback)((()=>{const e=R?.items||[];return r.createElement(r.Fragment,null,e.map(((e,t)=>r.createElement("div",{key:`bottomRightOverlayItem_${t}`},L(e)))))}),[R,L]);return r.createElement(m.No,{topLeft:A(),topRight:_(),bottomLeft:k(),bottomRight:H()})}O.propTypes={viewportData:a().object,imageIndex:a().number,viewportIndex:a().number};const C=O;var D=n(44921),x=n.n(D);const{getOrientationStringLPS:V,invertOrientationStringLPS:M}=s.utilities.orientation;function R(e){let{element:t,viewportData:n,imageSliceData:i,viewportIndex:o,servicesManager:a,orientationMarkers:s=["top","left"]}=e;const[c,m]=(0,r.useState)(0),[u,p]=(0,r.useState)(!1),[d,v]=(0,r.useState)(!1),{cornerstoneViewportService:E}=a.services;(0,r.useEffect)((()=>{const e=e=>{const{rotation:t,previousCamera:n,camera:r}=e.detail;void 0!==t&&m(t),void 0!==r.flipHorizontal&&n.flipHorizontal!==r.flipHorizontal&&p(r.flipHorizontal),void 0!==r.flipVertical&&n.flipVertical!==r.flipVertical&&v(r.flipVertical)};return t.addEventListener(l.Enums.Events.CAMERA_MODIFIED,e),()=>{t.removeEventListener(l.Enums.Events.CAMERA_MODIFIED,e)}}),[]);const g=(0,r.useMemo)((()=>{if(!n)return"";let e,a;if("stack"===n.viewportType){const t=i.imageIndex,r=n.data.imageIds?.[t];if(!r)return!1;({rowCosines:e,columnCosines:a}=l.metaData.get("imagePlaneModule",r)||{})}else{if(!t||!(0,l.getEnabledElement)(t))return"";const{viewport:n}=(0,l.getEnabledElement)(t),{viewUp:r,viewPlaneNormal:i}=n.getCamera(),o=f.R3.create();f.R3.cross(o,r,i),a=[-r[0],-r[1],-r[2]],e=o}if(!e||!a||void 0===c)return"";const m=function(e,t,n,r,i){const o=V(e),a=V(t),s=M(o),l={top:M(a),left:s,right:o,bottom:a};r&&(l.top=M(l.top),l.bottom=M(l.bottom));i&&(l.left=M(l.left),l.right=M(l.right));if(90===n||-270===n)return{top:l.left,left:M(l.top),right:M(l.bottom),bottom:l.right};if(-90===n||270===n)return{top:M(l.left),left:l.top,bottom:l.left,right:l.bottom};if(180===n||-180===n)return{top:M(l.top),left:M(l.left),bottom:M(l.bottom),right:M(l.right)};return l}(e,a,c,d,u),p=E.getViewportInfoByIndex(o);if(!p)return console.log("ViewportOrientationMarkers::No viewport"),null;const v=p.getViewportOptions().background,g=!!v&&l.utilities.isEqual(v,[1,1,1]);return s.map(((e,t)=>r.createElement("div",{className:x()(`${e}-mid orientation-marker`,g?"text-[#726F7E]":"text-[#ccc]"),key:`${e}-mid orientation-marker`},r.createElement("div",{className:"orientation-marker-value"},m[e]))))}),[n,i,c,d,u,s,t]);return r.createElement("div",{className:"ViewportOrientationMarkers noselect"},g)}R.propTypes={percentComplete:a().number,error:a().object},R.defaultProps={percentComplete:0,error:null};const N=R;function P(e){let{viewportData:t,element:n}=e;const[i,o]=(0,r.useState)(!1),[a,s]=(0,r.useState)(!1),c=(0,r.useRef)(null),m=(0,r.useRef)(null),u=e=>{clearTimeout(c.current),c.current=setTimeout((()=>{o(!0)}),50)},p=e=>{clearTimeout(c.current),o(!1)},d=e=>{clearTimeout(c.current),m.current===e.detail.imageId&&(s(e.detail.error),m.current=null)};return(0,r.useEffect)((()=>(n.addEventListener(l.Enums.Events.STACK_VIEWPORT_SCROLL,u),n.addEventListener(l.Enums.Events.IMAGE_LOAD_ERROR,d),n.addEventListener(l.Enums.Events.STACK_NEW_IMAGE,p),()=>{n.removeEventListener(l.Enums.Events.STACK_VIEWPORT_SCROLL,u),n.removeEventListener(l.Enums.Events.STACK_NEW_IMAGE,p),n.removeEventListener(l.Enums.Events.IMAGE_LOAD_ERROR,d)})),[n,t]),a?r.createElement(r.Fragment,null,r.createElement("div",{className:"bg-black opacity-50 absolute h-full w-full top-0 left-0"},r.createElement("div",{className:"flex transparent items-center justify-center w-full h-full"},r.createElement("p",{className:"text-primary-light text-xl font-light"},r.createElement("h4",null,"Error Loading Image"),r.createElement("p",null,"An error has occurred."),r.createElement("p",null,a))))):i?r.createElement("div",{className:"pointer-events-none bg-black opacity-50 absolute h-full w-full top-0 left-0"},r.createElement("div",{className:"flex transparent items-center justify-center w-full h-full"},r.createElement("p",{className:"text-primary-light text-xl font-light"},"Loading..."))):null}P.propTypes={percentComplete:a().number,error:a().object,element:a().object},P.defaultProps={percentComplete:0,error:null};const L=P;const A=function(e){const{viewportIndex:t,element:n,scrollbarHeight:i,servicesManager:o}=e,{cornerstoneViewportService:a}=o.services,[s,l]=(0,r.useState)({imageIndex:0,numberOfSlices:0}),[c,m]=(0,r.useState)(null);if((0,r.useEffect)((()=>{const{unsubscribe:e}=a.subscribe(a.EVENTS.VIEWPORT_DATA_CHANGED,(e=>{e.viewportIndex===t&&m(e.viewportData)}));return()=>{e()}}),[t]),!n)return null;if(c){const e=a.getViewportInfoByIndex(t);if(e?.viewportOptions?.customViewportProps?.hideOverlays)return null}return r.createElement("div",{className:"noselect"},r.createElement(d,{viewportIndex:t,viewportData:c,element:n,imageSliceData:s,setImageSliceData:l,scrollbarHeight:i,servicesManager:o}),r.createElement(C,{imageSliceData:s,viewportData:c,viewportIndex:t,servicesManager:o,element:n}),r.createElement(L,{viewportData:c,element:n}),r.createElement(N,{imageSliceData:s,element:n,viewportData:c,servicesManager:o,viewportIndex:t}))};var _=n(87172);const k=function(e){let{enabledVPElement:t,viewportIndex:n,servicesManager:i}=e;const{toolbarService:o,customizationService:a}=i.services,[{isCineEnabled:s,cines:c},u]=(0,m.vQ)(),[{activeViewportIndex:p}]=(0,m.O_)(),{component:d=m.H6}=a.get("cinePlayer")??{},f=()=>{if(!c||!c[n]||!t)return;const e=c[n],r=e.isPlaying||!1,i=e.frameRate||24,o=Math.max(i,1);r?u.playClip(t,{framesPerSecond:o}):u.stopClip(t)};(0,r.useEffect)((()=>(l.eventTarget.addEventListener(l.Enums.Events.STACK_VIEWPORT_NEW_STACK,f),()=>{u.setCine({id:n,isPlaying:!1}),l.eventTarget.removeEventListener(l.Enums.Events.STACK_VIEWPORT_NEW_STACK,f)})),[t]),(0,r.useEffect)((()=>{if(c&&c[n]&&t)return f(),()=>{t&&c?.[n]?.isPlaying&&u.stopClip(t)}}),[c,n,u,t,f]);const v=c[n],E=v&&v.isPlaying||!1;return s&&r.createElement(d,{className:"absolute left-1/2 -translate-x-1/2 bottom-3",isPlaying:E,onClose:()=>{o.recordInteraction({groupId:"MoreTools",itemId:"cine",interactionType:"toggle",commands:[{commandName:"toggleCine",commandOptions:{},context:"CORNERSTONE"}]})},onPlayPauseChange:e=>u.setCine({id:p,isPlaying:e}),onFrameRateChange:e=>u.setCine({id:p,frameRate:e})})};let H;function F(e,t){if(t.needsRerendering)return!1;if(e.displaySets.length!==t.displaySets.length)return!1;if(e.viewportOptions.orientation!==t.viewportOptions.orientation)return!1;if(e.viewportOptions.toolGroupId!==t.viewportOptions.toolGroupId)return!1;if(e.viewportOptions.viewportType!==t.viewportOptions.viewportType)return!1;const n=e.displaySets,r=t.displaySets;if(n.length!==r.length)return!1;for(let e=0;e<n.length;e++){const t=n[e],i=r.find((e=>e.displaySetInstanceUID===t.displaySetInstanceUID));if(!i)return!1;if(i.images?.length!==t.images?.length)return!1;if(i.images?.length)for(let e=0;e<i.images.length;e++)if(i.images[e].imageId!==t.images[e].imageId)return!1}return!0}const G=r.memo((e=>{const{viewportIndex:t,displaySets:n,dataSource:o,viewportOptions:a,displaySetOptions:p,servicesManager:d,onElementEnabled:f,onElementDisabled:v,isJumpToMeasurementDisabled:E,initialImageIndex:g}=e,[I,w]=(0,r.useState)("100px"),[S,y]=(0,r.useState)(null),b=(0,r.useRef)(),{measurementService:T,displaySetService:h,toolbarService:O,toolGroupService:C,syncGroupService:D,cornerstoneViewportService:x,cornerstoneCacheService:V,viewportGridService:M,stateSyncService:R}=d.services,[N]=(0,m.en)(),P=(0,r.useCallback)((()=>{const e=b.current.clientHeight-20+"px";w(e)}),[b]),L=(0,r.useCallback)((()=>{b.current&&(x.resize(),P())}),[b]),_=(0,r.useCallback)((()=>{const e=x.getViewportInfoByIndex(t);if(!e)return;const n=e.getViewportId(),r=e.getRenderingEngineId(),i=e.getSyncGroups();C.removeViewportFromToolGroup(n,r),D.removeViewportFromSyncGroup(n,r,i)}),[t,a.viewportId]),F=(0,r.useCallback)((e=>{if(e.detail.element!==b.current)return;const{viewportId:t,element:n}=e.detail,r=x.getViewportInfo(t),i=r.getViewportIndex();(0,u.Yc)(i,n),y(n);const o=r.getRenderingEngineId(),a=r.getToolGroupId(),s=r.getSyncGroups();C.addViewportToToolGroup(t,o,a),D.addViewportToSyncGroup(t,o,s),f&&f(e)}),[t,f,C]);return(0,r.useEffect)((()=>(x.enableViewport(t,a,b.current),l.eventTarget.addEventListener(l.Enums.Events.ELEMENT_ENABLED,F),P(),()=>{(()=>{const e=x.getPresentation(t);if(!e||!e.presentationIds)return;const{lutPresentationStore:n,positionPresentationStore:r}=R.getState(),{presentationIds:i}=e,{lutPresentationId:o,positionPresentationId:a}=i||{},s={};o&&(s.lutPresentationStore={...n,[o]:e}),a&&(s.positionPresentationStore={...r,[a]:e}),R.store(s)})(),_();const e=x.getViewportInfoByIndex(t);x.disableElement(t),v&&v(e),l.eventTarget.removeEventListener(l.Enums.Events.ELEMENT_ENABLED,F)})),[]),(0,r.useEffect)((()=>{const{unsubscribe:e}=h.subscribe(h.EVENTS.DISPLAY_SET_SERIES_METADATA_INVALIDATED,(async e=>{const n=x.getViewportInfoByIndex(t);if(n.hasDisplaySet(e)){const r=n.getViewportData(),i=await V.invalidateViewportData(r,e,o,h),a=!0;x.updateViewport(t,i,a)}}));return()=>{e()}}),[t]),(0,r.useEffect)((()=>{a.viewportType||(a.viewportType="stack");(async()=>{const e=await V.createViewportData(n,a,o,g),{lutPresentationStore:r,positionPresentationStore:i}=R.getState(),{presentationIds:l}=a,c={positionPresentation:i[l?.positionPresentationId],lutPresentation:r[l?.lutPresentationId]};let m;H?.viewportIndex===t&&(m=H.measurement,c.positionPresentation=null,H=null),x.setViewportData(t,e,a,p,c),m&&s.annotation.selection.setAnnotationSelected(m.uid)})()}),[a,n,o]),(0,r.useEffect)((()=>{if(E)return;const e=function(e,t,n,r,i,o,a){i.map((e=>e.displaySetInstanceUID));const{unsubscribe:s}=e.subscribe(c.MeasurementService.EVENTS.JUMP_TO_MEASUREMENT_VIEWPORT,(i=>{H=i;const{viewportIndex:s,measurement:l,isConsumed:c}=i;l&&!c&&(void 0===H.cornerstoneViewport&&(H.cornerstoneViewport=a.getViewportIndexToJump(s,l.displaySetInstanceUID,{referencedImageId:l.referencedImageId})),H.cornerstoneViewport===r&&z(l,n,r,e,t,o,a))}));return s}(T,h,b,t,n,M,x);return function(e,t,n,r,i,o,a){if(!H)return;if(H.isConsumed)return void(H=null);const s=i.map((e=>e.displaySetInstanceUID));if(!s?.length)return;const{measurement:l}=H;l&&n&&s.includes(l?.displaySetInstanceUID)&&z(l,n,r,e,t,o,a)}(T,h,b,t,n,M,x),()=>{e()}}),[n,b,t]),console.debug("OHIFCornerstoneViewport rendering"),r.createElement(r.Fragment,null,r.createElement("div",{className:"viewport-wrapper"},r.createElement(i.ZP,{refreshMode:"debounce",refreshRate:50,onResize:L,targetRef:b.current}),r.createElement("div",{className:"cornerstone-viewport-element",style:{height:"100%",width:"100%"},onContextMenu:e=>e.preventDefault(),onMouseDown:e=>e.preventDefault(),ref:b}),r.createElement(A,{viewportIndex:t,toolBarService:O,element:b.current,scrollbarHeight:I,servicesManager:d}),r.createElement(k,{enabledVPElement:S,viewportIndex:t,servicesManager:d})),r.createElement("div",{className:"absolute w-full"},N.viewportIndex===t&&r.createElement(m.P_,{id:"viewport-notification",message:N.message,type:N.type,actions:N.actions,onSubmit:N.onSubmit,onOutsideClick:N.onOutsideClick})))}),F);function z(e,t,n,r,i,o,a){const c=t.current,{displaySetInstanceUID:m,SOPInstanceUID:u,frameNumber:p}=e;if(!u)return void console.warn("cannot jump in a non-acquisition plane measurements yet");const d=i.getDisplaySetByUID(m);o.setActiveViewportIndex(n);const f=(0,l.getEnabledElement)(c);a.getViewportInfoByIndex(n);if(f){const t=f.viewport;let n=0,r=!0;if(t instanceof l.StackViewport){n=t.getImageIds().findIndex((e=>{const{SOPInstanceUID:t,frameNumber:n}=(0,_.Z)(e);return t===u&&(!p||p===n)}))}else{const{viewPlaneNormal:i}=e.metadata;n=d.images.findIndex((e=>e.SOPInstanceUID===u));const{viewPlaneNormal:o}=t.getCamera();i&&!l.utilities.isEqual(i.map(Math.abs),o.map(Math.abs))&&(r=!1)}if(!r||-1===n)return;s.utilities.jumpToSlice(c,{imageIndex:n}),s.annotation.selection.setAnnotationSelected(e.uid),H?.consume?.(),H=null}}G.displayName="OHIFCornerstoneViewport",G.defaultProps={isJumpToMeasurementDisabled:!1},G.propTypes={viewportIndex:a().number.isRequired,displaySets:a().array.isRequired,dataSource:a().object.isRequired,viewportOptions:a().object,displaySetOptions:a().arrayOf(a().any),servicesManager:a().object.isRequired,onElementEnabled:a().func,isJumpToMeasurementDisabled:a().bool,initialImageIdOrIndex:a().oneOfType([a().string,a().number])};const W=G}}]);
//# sourceMappingURL=181.bundle.9f29594323924be6b7d5.js.map